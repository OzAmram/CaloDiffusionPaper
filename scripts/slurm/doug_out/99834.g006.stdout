/net/projects/fermi-1/doug
TRAIN AUTOENCODER
/net/projects/fermi-1/doug/2023-Autumn-Clinic-Fermi-CaloDiffusionPaper
TRAINING OPTIONS
{'FILES': ['dataset_1_photons_1.hdf5'], 'EVAL': ['dataset_1_photons_2.hdf5'], 'BIN_FILE': '/work1/cms_mlsim/oamram/CaloDiffusion/CaloChallenge/code/binning_dataset_1_photons.xml', 'PART_TYPE': 'photon', 'AVG_SHOWER_LOC': '/wclustre/cms_mlsim/denoise/CaloChallenge/dataset_2_avg_showers.hdf5', 'DATASET_NUM': 1, 'HOLDOUT': 0, 'SHAPE_ORIG': [-1, 368], 'SHAPE': [-1, 5, 10, 30, 1], 'SHAPE_PAD': [-1, 1, 5, 10, 30], 'BATCH': 128, 'LR': '4e-4', 'MAXEPOCH': 1000, 'NLAYERS': 3, 'EARLYSTOP': 20, 'LAYER_SIZE_AE': [32, 64, 64, 32], 'DIM_RED_AE': [0, 2, 0, 2], 'LAYER_SIZE_UNET': [16, 16, 16, 32], 'COND_SIZE_UNET': 128, 'KERNEL': [3, 3, 3], 'STRIDE': [3, 2, 2], 'BLOCK_ATTN': True, 'MID_ATTN': True, 'COMPRESS_Z': True, 'ACT': 'swish', 'EMBED': 128, 'EMAX': 4194.304, 'EMIN': 0.256, 'ECUT': 1e-07, 'logE': True, 'MAXDEP': 3.1, 'CYLINDRICAL': True, 'SHOWERMAP': 'logit-norm', 'R_Z_INPUT': True, 'PHI_INPUT': True, 'BETA_MAX': 0.02, 'NOISE_SCHED': 'cosine', 'NSTEPS': 400, 'COLD_DIFFU': False, 'COLD_NOISE': 1.0, 'TRAINING_OBJ': 'noise_pred', 'LOSS_TYPE': 'l2', 'TIME_EMBED': 'sigma', 'COND_EMBED': 'id', 'SHOWER_EMBED': 'orig-NN', 'CHECKPOINT_NAME': 'dataset1_phot'}
Event start, stop:  0 None
dset 11
Data Shape (121000, 368)
CHECKING!!!!
True
True
Loading training checkpoint from ../ae_models/dataset1_phot_AE/checkpoint.pth
dict_keys(['epoch', 'model_state_dict', 'optimizer_state_dict', 'scheduler_state_dict', 'train_loss_hist', 'val_loss_hist', 'early_stop_dict'])
{'patience': 20, 'min_delta': 1e-05, 'counter': 19, 'min_validation_loss': inf, 'mode': 'diff'}
Beginning epoch 479
loss: 2.4494154670488247e-07
val_loss: 2.480009629394631e-07
Early stopping!
Saving to ../ae_models/dataset1_phot_AE/
